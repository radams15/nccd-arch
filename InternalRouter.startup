###### InternalRouter ######

# Interface Configuration

ip addr add 192.168.1.2/24 dev eth0
ifconfig eth0 up


ip addr add 172.26.0.1/24 dev eth1
ifconfig eth1 up


ip addr add 10.10.0.1/16 dev eth2
ifconfig eth2 up


ip addr add 192.168.4.2/24 dev eth3
ifconfig eth3 up


# Static Route Configuration

ip route add default via 192.168.1.1 
ip route add 172.36.0.0/24 via 10.10.0.2

# Firewall Rules

iptables --policy FORWARD DROP
iptables -A FORWARD -m state --state RELATED,ESTABLISHED -j ACCEPT

iptables -A POSTROUTING -t nat -s 10.10.0.0/16 -o eth1 -j SNAT --to-source 172.26.0.1
iptables -A POSTROUTING -t nat -s 10.10.0.0/16 -o eth0 -j SNAT --to-source 192.168.1.2

iptables -A FORWARD --match multiport -m state --state NEW -s 10.10.0.0/16 -d 172.16.0.2 -p tcp --dports 25,587,993 -j ACCEPT
iptables -A FORWARD --match multiport -m state --state NEW -s 172.26.0.2 -p tcp --dports 80,443 -j ACCEPT
iptables -A FORWARD -m state --state NEW -s 10.10.0.0/16 -d 172.26.0.2 -p tcp --dport 3129 -j ACCEPT
iptables -A FORWARD -m state --state NEW -s 10.10.0.0/16 -d 172.26.0.4 -p udp --dport 53 -j ACCEPT
iptables -A FORWARD -m conntrack --ctstate NEW -i eth1 -o eth0 -s 172.26.0.4 -p tcp --dport 53 -j ACCEPT
iptables -A FORWARD -m conntrack --ctstate NEW -i eth1 -o eth0 -s 172.26.0.4 -p udp --dport 53 -j ACCEPT
iptables -A FORWARD -m conntrack --ctstate NEW -i eth0 -o eth2 -p tcp --dport 1194 -j ACCEPT
